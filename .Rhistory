))
frq(data$part_deporte)
frq(data$part_deporte2)
frq(data$c11_04)
# Participación en organizaciones religiosas rec NA
data <- data %>%
mutate(part_religiosa=if_else(
c11_04 %in% c(-888, -999), 3, c11_04)
)
# Participación en organizaciones religiosas Dummy
data <- data %>%
mutate(part_religiosa2=case_when(
c11_04 %in% c(1, 2) ~ 1,
c11_04 %in% c(3, -888, -999) ~ 0
))
frq(data$part_religiosa)
frq(data$part_religiosa2)
frq(data$b06_01)
frq(data$b06_02)
frq(data$b06_03)
frq(data$b06_04)
frq(data$b06_05)
data <- data %>%
rowwise() %>%
mutate(autonomia_control = mean(c(b06_01, b06_02, b06_03, b06_04, b06_05))) %>%
ungroup()
descr(data$autonomia_control)
frq(data$b11)
data <- data %>%
mutate(part_trabajo=case_when(
b11 == 1 ~ 1,
b11 %in% c(2, -888, -999) ~ 0
))
frq(data$part_trabajo)
frq(data$b12)
data <- data %>%
mutate(
influye_trabajo = case_when(
part_trabajo == 0 ~ 0,
b12==1 ~ 1,
b12==2 ~ 2,
b12==3 ~ 3,
b12==4 ~ 4,
b12==5 ~ 5))
frq(data$influye_trabajo)
frq(data$sexo)
descr(data$edad)
data$edad <- car::recode(data$edad,
recodes=c("c(-888,-999)=NA"))
frq(data$e05)
data$nedu <- car::recode(data$e05,
recodes=c("c(-888,-999,1,2,3)='Hasta Básica completa';
c(4,5)='Hasta Media completa';
c(6,7,8)='Hasta Universitaria incompleta';
c(9,10)='Universitaria completa o más'"),
as.factor=TRUE,
levels=c('Hasta Básica completa',
'Hasta Media completa',
'Hasta Universitaria incompleta',
'Universitaria completa o más'))
frq(data$nedu)
frq(data$a25) # 19 + 46 NS/NR y 603 otro
frq(data$a25_esp) # 603 válidos
data$rama <- ifelse(data$a25 == 22,
data$a25_esp,  # Usar el valor de "a25_esp" si la categoría es 22
data$a25)      # En los demás casos, mantener el valor original de "a25"
frq(data$rama)
data <- mutate(data,
rama=factor(case_when(rama==1~"A",
rama==2|rama==3~"BC",
rama==4|rama==5|rama==6~"DEF",
rama==7|rama==8~"GI",
rama==9~"H",
rama==10|rama==11|rama==12|rama==13|rama==14~"JKLMN",
rama==15~"O",
rama==16|rama==17~"PQ",
rama==18|rama==19|rama==20~"RSU",
rama==21~"T")))
frq(data$rama)
frq(data$a26)
data$tamanio_empresa <- car::recode(data$a26,
recodes=c("c(1,2,3)='1-9';
c(4,5)='10-49';
c(6,7)='50-199';
c(8,9)='200 o más'"),
as.factor = TRUE,
levels=c('1-9',
'10-49',
'50-199',
'200 o más'))
frq(data$tamanio_empresa)
frq(data$a27)
data$tamanio_local <- car::recode(data$a27,
recodes=c("c(1,2,3)='1-9';
c(4,5)='10-49';
c(6,7)='50-199';
c(8,9)='200 o más'"),
as.factor = TRUE,
levels=c('1-9',
'10-49',
'50-199',
'200 o más'))
frq(data$tamanio_local)
frq(data$a07)
data <- data %>%
mutate(sector=case_when(
a07 %in% c(1, 2, 5, 6, 7, 9) ~ 1,
a07 %in% c(3, 4, 8) ~ 0
))
frq(data$sector)
frq(data$a15)
data <- data %>%
mutate(supervisa=case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
a15 %in% c(1,2) ~ 1,
a15 == 3 ~ 2,
a15 == 4 ~ 3
))
frq(data$supervisa)
save(data,file="../output/datos-ilpc.Rdata")
frq(data$c09_esp)
frq(data$c12_01)
frq(data$c12_02)
# Reemplazar -888 y -999 por NA en ambas variables
data$c12_01_clean <- ifelse(data$c12_01 %in% c(-888, -999), NA, data$c12_01)
data$c12_02_clean <- ifelse(data$c12_02 %in% c(-888, -999), NA, data$c12_02)
# Calcular el promedio solo con los valores válidos
data$political_skills <- rowMeans(cbind(data$c12_01_clean, data$c12_02_clean), na.rm = TRUE)
descr(data$political_skills)
frq(data$c09)
data <- data %>%
mutate(pol_left_id=if_else(
c09 %in% c(1, 2, 3, 13) | c09_esp %in% c("anarquista","PC(AC)"),1,0
))
frq(data$pol_left_id)
frq(data$pol_left_id)
frq(data$c09_esp)
data <- data %>%
mutate(pol_left_id=if_else(
c09 %in% c(1, 2, 3, 13) | c09_esp %in% c("frente amplio","anarquismo","PC(AC)"),1,0
))
frq(data$pol_left_id)
rm(list=ls())
options(scipen = 999)
library(pacman)
p_load(tidyverse,
knitr,
bookdown,
car,
sjmisc,
sjPlot,
sjlabelled,
psych,
kableExtra,
gridExtra,
lubridate,
viridis,
statar,
readxl,
tinytex,
ggrepel,
ggalluvial,
survey,
httr,
readr,
ggplot2,
labelled,
shadowtext,
stringr)
# data_raw <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=3)
# data_dec <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=2)
load("input/data/datos-conclat.Rdata")
data <- data %>%
select(id,
a07,
rake_wb2,
# Var independientes
b19,
b21,
b29,
# Var dependientes
c04_01,c04_02,c04_03,c04_04,
c10_01,c10_02,
c11_01,c11_02,c11_03,c11_04,
c08,
c09,c09_esp,
c12_01,c12_02,
# Var mediadoras
b06_01,b06_02,b06_03,b06_04,b06_05,
b11,b12,
# Var control
sexo=e01,
edad=e02,
e05,
a15,
a25,a25_esp,
a26,
a27)# %>%
#sjlabelled::set_na(.,na=c(-999,-888,-777))
# Situación empleo
data <- data %>%
mutate(
a07 = data$a07 %>%
set_labels(label = "Situación de empleo",
labels = c(
"Patrón(a) o empleador(a)" = 1,
"Trabajador(a) por cuenta propia" = 2,
"Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)" = 3,
"Empleado(a) u obrero(a) de empresas públicas" = 4,
"Empleado(a) u obrero(a) del sector privado" = 5,
"Servicio doméstico puertas adentro" = 6,
"Servicio doméstico puertas afuera" = 7,
"FF.AA. y del Orden" = 8,
"Familiar no remunerado" = 9)) %>%
as_factor(ref = "labels"))
frq(data$a07)
data <- data %>%
mutate(
sit_empleo = factor(
case_when(
as_numeric(a07) == 1 ~ "Empleador(a)",
as_numeric(a07) == 2 ~ "Autoempleado(a)",
as_numeric(a07) >= 3 ~ "Empleado(a)",
TRUE ~ NA_character_),
levels = c("Empleador(a)","Autoempleado(a)","Empleado(a)")))
frq(data$sit_empleo)
View(data)
# data_raw <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=3)
# data_dec <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=2)
load("input/data/datos-conclat.Rdata")
data <- data %>%
select(id,
a07,
rake_wb2,
# Var independientes
b19,
b21,
b29,
# Var dependientes
c04_01,c04_02,c04_03,c04_04,
c10_01,c10_02,
c11_01,c11_02,c11_03,c11_04,
c08,
c09,c09_esp,
c12_01,c12_02,
# Var mediadoras
b06_01,b06_02,b06_03,b06_04,b06_05,
b11,b12,
# Var control
sexo=e01,
edad=e02,
e05,
a15,
a25,a25_esp,
a26,
a27)# %>%
#sjlabelled::set_na(.,na=c(-999,-888,-777))
class(a07)
class(data$a07)
# Situación empleo
data <- data %>%
mutate(
a07 = a07 %>%
set_variable_labels(label = "Situación de empleo") %>%
set_value_labels(
"Patrón(a) o empleador(a)" = 1,
"Trabajador(a) por cuenta propia" = 2,
"Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)" = 3,
"Empleado(a) u obrero(a) de empresas públicas" = 4,
"Empleado(a) u obrero(a) del sector privado" = 5,
"Servicio doméstico puertas adentro" = 6,
"Servicio doméstico puertas afuera" = 7,
"FF.AA. y del Orden" = 8,
"Familiar no remunerado" = 9
) %>%
as_factor(ref = "labels"))
frq(data$a07)
data <- data %>%
mutate(
sit_empleo = case_when(
as_numeric(a07) == 1 ~ 1,
as_numeric(a07) == 2 ~ 2,
as_numeric(a07) >= 3 ~ 3,
TRUE ~ NA_real_
),
sit_empleo = labelled(
sit_empleo,
labels = c(
"Empleador(a)" = 1,
"Autoempleado(a)" = 2,
"Empleado(a)" = 3
)
),
sit_empleo = as_factor(sit_empleo, ref = "labels")
)
frq(data$sit_empleo)
frq(data$b29)
# Afiliación sindical
data <- data %>%
mutate(
int_sindical = case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
af_sindical == 1 ~ 1,
af_sindical == 0 & b29 %in% c(4,5) ~ 2,
af_sindical == 0 & b29 %in% c(1, 2, 3, -888, -999) ~ 3
),
int_sindical = labelled(
int_sindical,
labels = c(
"union member" = 1,
"probably member" = 2,
"not member" = 3
)
),
int_sindical = as_factor(int_sindical, ref = "labels")
)
frq(data$b19)
# Sindicatos en empresas
data <- data %>%
mutate(sindicato=case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
sit_empleo == 'Empleado(a)' & b19 == 1 ~ 1,
sit_empleo == 'Empleado(a)' & b19 %in% c(2, -888, -999) ~ 0
))
frq(data$sindicato)
frq(data$b21)
# Afiliación sindical
data <- data %>%
mutate(af_sindical=case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
sit_empleo == 'Empleado(a)' & b21 %in% c(1, 2) ~ 1,
sit_empleo == 'Empleado(a)' & b21 %in% c(3, -888, -999) ~ 0,
sindicato == 0 ~ 0
))
frq(data$af_sindical)
# Afiliación sindical
data <- data %>%
mutate(
int_sindical = case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
af_sindical == 1 ~ 1,
af_sindical == 0 & b29 %in% c(4,5) ~ 2,
af_sindical == 0 & b29 %in% c(1, 2, 3, -888, -999) ~ 3
),
int_sindical = labelled(
int_sindical,
labels = c(
"union member" = 1,
"probably member" = 2,
"not member" = 3
)
),
int_sindical = as_factor(int_sindical, ref = "labels")
)
frq(data$int_sindical)
# data_raw <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=3)
# data_dec <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=2)
load("input/data/datos-conclat.Rdata")
data <- data %>%
select(id,
a07,
rake_wb2,
# Var independientes
b19,
b21,
b29,
# Var dependientes
c04_01,c04_02,c04_03,c04_04,
c10_01,c10_02,
c11_01,c11_02,c11_03,c11_04,
c08,
c09,c09_esp,
c12_01,c12_02,
# Var mediadoras
b06_01,b06_02,b06_03,b06_04,b06_05,
b11,b12,
# Var control
sexo=e01,
edad=e02,
e05,
a15,
a25,a25_esp,
a26,
a27)# %>%
#sjlabelled::set_na(.,na=c(-999,-888,-777))
# Situación empleo
data <- data %>%
mutate(
a07 = a07 %>%
set_variable_labels(label = "Situación de empleo") %>%
set_value_labels(
"Patrón(a) o empleador(a)" = 1,
"Trabajador(a) por cuenta propia" = 2,
"Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)" = 3,
"Empleado(a) u obrero(a) de empresas públicas" = 4,
"Empleado(a) u obrero(a) del sector privado" = 5,
"Servicio doméstico puertas adentro" = 6,
"Servicio doméstico puertas afuera" = 7,
"FF.AA. y del Orden" = 8,
"Familiar no remunerado" = 9
) %>%
as_factor(ref = "labels"))
frq(data$a07)
data <- data %>%
mutate(
sit_empleo = case_when(
as_numeric(a07) == 1 ~ 1,
as_numeric(a07) == 2 ~ 2,
as_numeric(a07) >= 3 ~ 3,
TRUE ~ NA_real_
)) %>%
mutate(
sit_empleo = sit_empleo %>%
set_variable_labels(label = "Situación de empleo") %>%
set_value_labels(
"Empleador(a)" = 1,
"Autoempleado(a)" = 2,
"Empleado(a)" = 3
) %>%
as_factor(ref = "labels"))
frq(data$sit_empleo)
levels(data$sit_empleo)
levels(data$a07)
label(data$a07)
labels(data$a07)
# data_raw <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=3)
# data_dec <- read_excel(here::here("input","data","Fondecyt Prof Pablo Pérez-Conclat, ultima version - 31-03-2025.xlsx"),sheet=2)
load("input/data/datos-conclat.Rdata")
data <- data %>%
select(id,
a07,
rake_wb2,
# Var independientes
b19,
b21,
b29,
# Var dependientes
c04_01,c04_02,c04_03,c04_04,
c10_01,c10_02,
c11_01,c11_02,c11_03,c11_04,
c08,
c09,c09_esp,
c12_01,c12_02,
# Var mediadoras
b06_01,b06_02,b06_03,b06_04,b06_05,
b11,b12,
# Var control
sexo=e01,
edad=e02,
e05,
a15,
a25,a25_esp,
a26,
a27)# %>%
#sjlabelled::set_na(.,na=c(-999,-888,-777))
# Situación empleo
data <- data %>%
mutate(
a07 = a07 %>%
set_variable_labels(label = "Situación de empleo") %>%
set_value_labels(
"Patrón(a) o empleador(a)" = 1,
"Trabajador(a) por cuenta propia" = 2,
"Empleado(a) u obrero(a) del sector público (Gobierno Central o Municipal)" = 3,
"Empleado(a) u obrero(a) de empresas públicas" = 4,
"Empleado(a) u obrero(a) del sector privado" = 5,
"Servicio doméstico puertas adentro" = 6,
"Servicio doméstico puertas afuera" = 7,
"FF.AA. y del Orden" = 8,
"Familiar no remunerado" = 9
) %>%
as_factor(ref = "labels"))
levels(data$a07)
frq(data$a07)
data <- data %>%
mutate(
sit_empleo = case_when(
as_numeric(a07) == 1 ~ 1,
as_numeric(a07) == 2 ~ 2,
as_numeric(a07) >= 3 ~ 3,
TRUE ~ NA_real_
)) %>%
mutate(
sit_empleo = sit_empleo %>%
set_variable_labels(label = "Situación de empleo 2") %>%
set_value_labels(
"Empleador(a)" = 1,
"Autoempleado(a)" = 2,
"Empleado(a)" = 3
) %>%
as_factor(ref = "labels"))
frq(data$sit_empleo)
frq(data$b19)
# Sindicatos en empresas
data <- data %>%
mutate(sindicato=case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
sit_empleo == 'Empleado(a)' & b19 == 1 ~ 1,
sit_empleo == 'Empleado(a)' & b19 %in% c(2, -888, -999) ~ 0
))
frq(data$sindicato)
frq(data$b19)
# Sindicatos en empresas
data <- data %>%
mutate(sindicato=case_when(
sit_empleo %in% c("Empleador(a)", "Autoempleado(a)") ~ NA_real_,
sit_empleo == 'Empleado(a)' & b19 == 1 ~ 1,
sit_empleo == 'Empleado(a)' & b19 %in% c(2, -888, -999) ~ 0
))
frq(data$sindicato)
table(data$sit_empleo)
frq(data$sit_empleo)
